<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hệ Thống Quản Lý Bệnh Viện </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            background-image: url('https://kientrucbenhvien.com/wp-content/uploads/2019/09/thiet-ke-benh-vien-115c-1024x576.jpg');
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            color: #f3f4f6;
            font-family: 'Roboto', sans-serif;
        }

        .header-box {
            background: linear-gradient(135deg, #ef4444 0%, #b91c1c 100%);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
            border: 2px solid #fca5a5;
            border-radius: 12px;
        }

        /* CODE DISPLAY STYLES - Áp dụng cho cả Minimized và Maximized */
        .code-window {
            background-color: #1e1e2e; /* Màu nền tối kiểu Dracula */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            border: 1px solid #444;
            display: flex; 
            flex-direction: column;
            height: 100%;
        }

        .code-sidebar {
            background-color: #2b2b3b;
            border-right: 1px solid #444;
            overflow-y: auto;
            flex-shrink: 0;
            width: 25%;
        }
        
        .code-content-area {
            background: #282a36;
            overflow: auto;
            padding: 16px;
            flex-grow: 1;
            width: 75%;
        }
        
        .code-main-flex {
            display: flex;
            flex-grow: 1;
        }

        .file-tab {
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }

        .file-tab:hover {
            background-color: #393950;
        }

        .file-tab.active {
            background-color: #323246;
            border-left: 3px solid #ff79c6;
            color: #ff79c6;
            font-weight: bold;
        }

        pre {
            font-family: 'Roboto Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            overflow-x: auto;
            white-space: pre-wrap;
            color: #f8f8f2; /* Màu chữ mặc định trắng ngà */
        }

        /* MINIMIZED VIEW - Khung Code ở giao diện chính */
        .minimized-host {
            height: 800px; /* Chiều cao cố định */
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            cursor: pointer; /* Toàn bộ khung thu nhỏ có thể click để mở rộng */
        }
        
        /* Nút Maximize */
        #maximize-button {
            position: absolute;
            top: 0;
            right: 0;
            padding: 12px;
            background-color: rgba(239, 68, 68, 0.9); /* Red-500 */
            color: white;
            z-index: 10;
            border-bottom-left-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 4px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }
        #maximize-button:hover {
            background-color: rgba(185, 28, 28, 0.95); /* Red-700 */
        }

        .diagram-container {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 20px;
            color: #333;
        }
        
        .logo-container {
            position: absolute;
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
            z-index: 10;
        }

        .website-logo {
            width: 100px;
            height: 100px;
            object-fit: contain;
            border-radius: 8px;
        }

        /* MODAL STYLES */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            z-index: 50;
            display: none;
            overflow: hidden;
        }

        .modal-content {
            height: 90vh;
            width: 90vw;
            margin: 5vh auto;
            position: relative;
        }

        .close-button {
            position: absolute;
            top: -30px;
            right: 0px;
            color: white;
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }

        .close-button:hover {
            color: #ef4444;
        }
        
        /* CSS cho Image Modal */
        #image-modal-content {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            width: 100%;
            padding: 20px;
            position: relative; 
        }

        #image-modal .close-button {
            top: 20px;
            right: 40px;
            font-size: 40px;
            z-index: 60;
            color: #fca5a5;
        }

        #modal-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
            border-radius: 8px;
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <div class="max-w-7xl mx-auto mb-10">
        <div class="header-box p-6 text-center transform hover:scale-[1.01] transition-transform duration-300">
            <div class="logo-container">
                <a href="/">
                    <img src="https://upload.wikimedia.org/wikipedia/vi/0/0e/Logo_MTA_new.png" alt="Logo MTA" class="website-logo">
                </a>
            </div>
            <h1 class="text-4xl md:text-5xl font-bold text-white uppercase tracking-wider drop-shadow-md">
                Quản Lý Bệnh Viện
            </h1>
            <p class="mt-2 text-red-100 text-lg">Hopital Management </p>
        </div>
    </div>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        <div class="lg:col-span-1 space-y-6">
            
            <div class="bg-gray-800 p-6 rounded-xl border border-gray-600 shadow-lg">
                <h2 class="text-2xl font-bold text-orange-400 mb-4 border-b border-gray-600 pb-2">Nguyên Tắc Thiết Kế</h2>
                <ul class="space-y-3">
                    <li class="flex items-start">
                       <span class="text-pink-500 mr-2">➤</span>
                        <div>
                            <strong class="text-pink-400">Tự Động Sinh ID:</strong>
                            <p class="text-sm text-gray-300">Sử dụng lớp <code class="text-red-400">AUTOID</code> với biến <code class="text-red-400">static</code> để quản lý và sinh ID duy nhất cho các đối tượng như <span class="text-orange-400">Room</span>.</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-pink-500 mr-2">➤</span>
                        <div>
                            <strong class="text-pink-400">Tính Kế Thừa:</strong>
                            <p class="text-sm text-gray-300"><span class="text-orange-400">Doctor</span> &lt;- <span class="text-orange-400">Employee</span> &lt;- <span class="text-orange-400">Person</span>.</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-pink-500 mr-2">➤</span>
                        <div>
                            <strong class="text-pink-400">Tính Đa Hình (Polymorphism):</strong>
                            <p class="text-sm text-gray-300">Hàm ảo <code class="text-red-400">virtual void display()</code> được sử dụng để hiển thị thông tin riêng biệt của các lớp con.</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-pink-500 mr-2">➤</span>
                        <div>
                            <strong class="text-pink-400">Nạp Chồng Toán Tử (Overloading):</strong>
                            <p class="text-sm text-gray-300">Sử dụng <code class="text-red-400">friend ostream& operator&lt;&lt;</code> cho class <span class="text-orange-400">Medicine</span>.</p>
                        </div>
                    </li>
                </ul>
            </div>
            

            <div class="bg-gray-800 p-1 rounded-xl border border-gray-600 shadow-2xl">
                <h2 class="text-3xl font-extrabold text-orange-400 m-4 text-center">Sơ Đồ Lớp </h2>
                
                <div class="diagram-container overflow-x-auto p-4 flex justify-center items-center">
                    <!-- Ảnh sơ đồ lớp, click để mở modal -->
                    <img src="https://i.postimg.cc/DwDP76fS/Gemini-Generated-Image-osxq1yosxq1yosxq.png" 
                         alt="Sơ đồ lớp Hệ Thống Quản Lý Bệnh Viện" 
                         class="w-full h-auto max-w-full rounded-lg shadow-lg cursor-pointer"
                         onclick="openImageModal(this.src)"> </div>
            </div>
        </div>

        <div id="code-host-minimized" class="lg:col-span-2 minimized-host border-2 border-gray-700" onclick="openModal()">
            
            <div id="maximize-button">
                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-maximize-2"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/></svg>
                 <span class="text-sm font-semibold hidden sm:inline">MỞ FULL SCREEN</span>
            </div>

            <div id="code-display-area" class="code-window h-full w-full">
                <div class="bg-gray-900 p-3 border-b border-gray-700 flex justify-between items-center flex-shrink-0">
                    <div class="flex space-x-2">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    </div>
                    <span class="text-gray-400 text-sm font-mono" id="current-filename">main.cpp</span>
                </div>

                <div class="code-main-flex flex-1 overflow-hidden">
                    <div class="code-sidebar overflow-y-auto" id="file-list">
                        </div>
                    <div class="code-content-area overflow-auto relative flex-grow">
                        <!-- Đổi id để JS xử lý -->
                        <pre><code id="code-content" class="language-cpp"></code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-gray-900 text-white py-8 border-t border-gray-800 mt-8">
        <div class="container mx-auto px-4 flex flex-col md:flex-row justify-between items-center">
            
            <div class="design-by-container mb-6 md:mb-0 text-center md:text-left">
                <p class="design-by-text text-sm text-gray-400">
                    Design by <b class="text-white font-semibold tracking-wider">Sơn Cris</b>
                </p>
                <p class="text-xs text-gray-600 mt-1">&copy; 2025 Lập trình hướng đối tượng</p>
            </div>

            <div class="contact-links-container flex flex-wrap justify-center gap-3 sm:gap-4">
                
                <a href="tel:0327208690" title="Gọi 0327208690" class="footer-link phone-link flex items-center space-x-2 px-4 py-2 rounded-full text-sm font-medium transition duration-300 ease-in-out transform hover:scale-105 shadow-md bg-green-600 hover:bg-green-700 text-white">
                    <svg class="footer-icon w-4 h-4 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M164.9 24.6c-48 0-87.1 39.1-87.1 87.1v278.7c0 48 39.1 87.1 87.1 87.1h182.2c48 0 87.1-39.1 87.1-87.1V111.7c0-48-39.1-87.1-87.1-87.1H164.9zM256 464c-15.4 0-27.9-12.5-27.9-27.9s12.5-27.9 27.9-27.9 27.9 12.5 27.9 27.9-12.5 27.9-27.9 27.9zm135.2-348.8H122.9V392h268.3V115.2z"/></svg>
                    <span>0327208690</span>
                </a>
                
                <a href="https://www.instagram.com/son_cris3012/" target="_blank" title="Instagram" class="footer-link instagram-link flex items-center space-x-2 px-4 py-2 rounded-full text-sm font-medium transition duration-300 ease-in-out transform hover:scale-105 shadow-md bg-pink-600 hover:bg-pink-700 text-white">
                    <svg class="footer-icon w-4 h-4 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224.1 12.6C99.2-22.3-22.3 99.2 12.6 224.1l11.2 11.2c19.3 19.3 46.4 30.1 74.5 30.1h145.4c28.1 0 55.2-10.8 74.5-30.1l11.2-11.2C485.6 99.2 364.1-22.3 239.1 12.6L224.1 27.7l-15 42.1c-14.4 40.3-43.7 70.8-82.6 86.6L48.2 168.1C25.3 177.1 8.5 197.6 8.5 221v82c0 23.4 16.8 43.9 39.7 52.9l84.4 32.1c38.9 15.8 68.2 46.3 82.6 86.6l15 42.1 15-42.1c14.4-40.3 43.7-70.8 82.6-86.6l84.4-32.1c22.9-9 39.7-29.5 39.7-52.9v-82c0-23.4-16.8-43.9-39.7-52.9l-84.4-32.1c-38.9-15.8-68.2-46.3-82.6-86.6l-15-42.1L224.1 27.7zM169.1 296.8c-29.4-29.4-29.4-77 0-106.4s77-29.4 106.4 0 29.4 77 0 106.4-77 29.4-106.4 0zm53.2-61.9c-15.5-15.5-15.5-40.7 0-56.2s40.7-15.5 56.2 0 15.5 40.7 0 56.2-40.7 15.5-56.2 0zm117.8 7.3c15.2-15.2 15.2-39.8 0-55s-39.8-15.2-55 0c-15.2 15.2-15.2 39.8 0 55s39.8 15.2 55 0z"/></svg>
                    <span>Instagram</span>
                </a>
                
                <a href="https://web.facebook.com/sonsadboiz.12" target="_blank" title="Facebook" class="footer-link facebook-link flex items-center space-x-2 px-4 py-2 rounded-full text-sm font-medium transition duration-300 ease-in-out transform hover:scale-105 shadow-md bg-blue-600 hover:bg-blue-700 text-white">
                    <svg class="footer-icon w-4 h-4 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h137.25V327.37h-51.2v-60.3h51.2v-44.4a76.43 76.43 0 0 1 76.4-76.4h37.7v59.7h-37.7c-25.1 0-25.1 9.2-25.1 25.4v40.7h63.2l-10.1 60.3h-53.1V480H400a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48z"/></svg>
                    <span>Facebook</span>
                </a>
            </div>
        </div>
    </footer>


    <div id="code-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal()">
                &times; </span>

            <div id="code-host-maximized" class="h-full w-full">
                </div>
        </div>
    </div>
    
    <!-- IMAGE MODAL -->
    <div id="image-modal" class="modal">
        <div id="image-modal-content">
            <span class="close-button" onclick="closeImageModal()">
                &times; 
            </span>
            <img id="modal-image" src="" alt="Sơ đồ lớp phóng to">
        </div>
    </div>
    
    <script>
        // Các phần tử DOM
        const codeModal = document.getElementById('code-modal');
        const codeHostMinimized = document.getElementById('code-host-minimized');
        const codeHostMaximized = document.getElementById('code-host-maximized');
        const codeDisplayArea = document.getElementById('code-display-area');
        const fileListEl = document.getElementById('file-list');
        const codeContentEl = document.getElementById('code-content');
        const fileNameEl = document.getElementById('current-filename');
        const maximizeButton = document.getElementById('maximize-button');
        
        const imageModal = document.getElementById('image-modal');
        const modalImage = document.getElementById('modal-image');


        // Dữ liệu Code (21 file C++)
        const codeFiles = {
            "AUTOID.h": `#pragma once

class AUTOID {
public:
    static int generateID();
};

`,
            "AUTOID.cpp": `#include "AUTOID.h"

int AUTOID::generateID() {
    static int id = 0;
    id++;
    return id;
}`,
            "Schedule.h": `#pragma once
#include <iostream>
#include <string>
using namespace std;

class Schedule {
private:
    string timeSlot;
public:
    Schedule();
    Schedule(string time);
    string getTimeSlot();
};

`,
            "Schedule.cpp": `#include "Schedule.h"

Schedule::Schedule() {
    timeSlot = "";
}

Schedule::Schedule(string time) {
    timeSlot = time;
}

string Schedule::getTimeSlot() {
    return timeSlot;
}`,
            "Medicine.h": `#pragma once
#include <iostream>
#include <string>
using namespace std;

class Medicine {
private:
    string name;
    int stock;
public:
    Medicine();
    Medicine(string n, int s);
    string getName();
    int getStock();
    // Nạp chồng toán tử << để in thông tin thuốc
    friend ostream& operator<<(ostream& os, Medicine& m);
};

`,
            "Medicine.cpp": `#include "Medicine.h"

Medicine::Medicine() {
    name = "";
    stock = 0;
}

Medicine::Medicine(string n, int s) {
    name = n;
    stock = s;
}

string Medicine::getName() {
    return name;
}

int Medicine::getStock() {
    return stock;
}

// Định nghĩa nạp chồng toán tử <<
ostream& operator<<(ostream& os, Medicine& m) {
    os << "   - Thuoc: " << m.name << " | So luong: " << m.stock;
    return os;
}`,
            "MedicalRecord.h": `#pragma once

#include <iostream>
#include <string>
#include "Medicine.h" 
using namespace std;

class MedicalRecord {
private:
    string diagnosis;
    Medicine prescribedList[100];
    int medicineCount;
public:
    MedicalRecord();
    MedicalRecord(string diag);
    void addMedicine(Medicine m);
    void displayRecord();
};

`,
            "MedicalRecord.cpp": `#include "MedicalRecord.h"

MedicalRecord::MedicalRecord() {
    diagnosis = "Chua chuan doan";
    medicineCount = 0;
}

MedicalRecord::MedicalRecord(string diag) {
    diagnosis = diag;
    medicineCount = 0;
}

void MedicalRecord::addMedicine(Medicine m) {
    if (medicineCount < 100) {
        prescribedList[medicineCount] = m;
        medicineCount++;
    } else {
        cout << "Loi: Don thuoc da day!" << endl;
    }
}

void MedicalRecord::displayRecord() {
    cout << "Chan doan: " << diagnosis << endl;
    cout << "Danh sach thuoc ke don:" << endl;
    for (int i = 0; i < medicineCount; i++) {
        // Sử dụng toán tử << đã nạp chồng
        cout << prescribedList[i] << endl; 
    }
}`,
            "Room.h": `#pragma once
#include "AUTOID.h"
#include <iostream>
using namespace std;

class Room {
private:
    int roomNumber;
    double price;
public:
    Room();
    Room(double p);
    int getRoomNumber();
    double getPrice();
};

`,
            "Room.cpp": `#include "Room.h"

Room::Room() {
    // Sử dụng AUTOID để tự động sinh số phòng
    roomNumber = AUTOID::generateID(); 
    price = 0.0;
}

Room::Room(double p) {
    roomNumber = AUTOID::generateID();
    price = p;
}

int Room::getRoomNumber() {
    return roomNumber;
}

double Room::getPrice() {
    return price;
}`,
            "Person.h": `#pragma once
#include <iostream>
#include <string>
using namespace std;

class Person {
protected:
    string name;
    int age;
public:
    Person();
    Person(string n, int a);
    // Hàm ảo cho tính đa hình
    virtual void display(); 
};

`,
            "Person.cpp": `#include "Person.h"

Person::Person() {
    name = "Khong ten";
    age = 0;
}

Person::Person(string n, int a) {
    name = n;
    age = a;
}

void Person::display() {
    cout << "Ho ten: " << name << ", Tuoi: " << age;
}`,
            "Employee.h": `#pragma once
#include "Person.h"

class Employee : public Person {
public:
    Employee();
    Employee(string n, int a);
    void schedule();
    // Ghi đè hàm display
    void display(); 
};

`,
            "Employee.cpp": `#include "Employee.h"

Employee::Employee() : Person() {}

Employee::Employee(string n, int a) : Person(n, a) {}

void Employee::schedule() {
    cout << "Nhan vien dang xem lich." << endl;
}

void Employee::display() {
    Person::display();
    cout << " [Chuc vu: Nhan vien]";
}`,
            "Doctor.h": `#pragma once
#include "Employee.h"
#include "Schedule.h"

class Doctor : public Employee {
private:
    string specialization;
    Schedule doctorSchedule;
public:
    Doctor();
    Doctor(string n, int a, string spec, string time);
    // Hành động chuyên môn của bác sĩ
    void virter(); 
    // Ghi đè hàm display
    void display();
};

`,
            "Doctor.cpp": `#include "Doctor.h"

Doctor::Doctor() : Employee() {
    specialization = "Da khoa";
}

Doctor::Doctor(string n, int a, string spec, string time) : Employee(n, a) {
    specialization = spec;
    doctorSchedule = Schedule(time);
}

void Doctor::virter() {
    cout << "Bac si " << name << " dang thuc hien chuyen mon: " << specialization << endl;
}

void Doctor::display() {
    cout << "--------------------------------" << endl;
    cout << "BAC SI: ";
    Person::display();
    cout << endl << "Chuyen khoa: " << specialization << endl;
    cout << "Ca truc: " << doctorSchedule.getTimeSlot() << endl;
}`,
            "Patient.h": `#pragma once
#include "Person.h"
#include "MedicalRecord.h"

class Patient : public Person {
private:
    MedicalRecord record;
    int roomNumber;
public:
    Patient();
    Patient(string n, int a, int rNum, string diagnosis);
    void addMedicineToRecord(Medicine m);
    // Ghi đè hàm display
    void display(); 
};

`,
            "Patient.cpp": `#include "Patient.h"

Patient::Patient() : Person() {
    roomNumber = 0;
}

Patient::Patient(string n, int a, int rNum, string diagnosis) : Person(n, a) {
    roomNumber = rNum;
    record = MedicalRecord(diagnosis);
}

void Patient::addMedicineToRecord(Medicine m) {
    record.addMedicine(m);
}

void Patient::display() {
    cout << "--------------------------------" << endl;
    cout << "BENH NHAN: ";
    Person::display();
    cout << endl << "Phong so: " << roomNumber << endl;
    record.displayRecord();
}`,
            "Hospital.h": `#pragma once
#include "Doctor.h"
#include "Patient.h"
#include "Room.h"

class Hospital {
private:
    // Mảng lưu trữ các đối tượng
    Doctor doctors[50];
    int doctorCount;
    
    Patient patients[100];
    int patientCount;
    
    Room rooms[20];
    int roomCount;

public:
    Hospital();
    void addDoctor(Doctor d);
    void addPatient(Patient p);
    void addRoom(Room r);
    // Phương thức quản lý hệ thống
    void manageSystem(); 
};

`,
            "Hospital.cpp": `#include "Hospital.h"

Hospital::Hospital() {
    doctorCount = 0;
    patientCount = 0;
    roomCount = 0;
}

void Hospital::addDoctor(Doctor d) {
    if (doctorCount < 50) {
        doctors[doctorCount] = d;
        doctorCount++;
    } else {
        // Thêm thông báo lỗi (ví dụ)
        cout << "Loi: Khong the them bac si, danh sach da day." << endl; 
    }
}

void Hospital::addPatient(Patient p) {
    if (patientCount < 100) {
        patients[patientCount] = p;
        patientCount++;
    } else {
        cout << "Loi: Khong the them benh nhan, danh sach da day." << endl;
    }
}

void Hospital::addRoom(Room r) {
    if (roomCount < 20) {
        rooms[roomCount] = r;
        roomCount++;
    } else {
        cout << "Loi: Khong the them phong, danh sach da day." << endl;
    }
}

void Hospital::manageSystem() {
    cout << "========== QUAN LY BENH VIEN ==========" << endl << endl;
    
    cout << ">>> DANH SACH PHONG (" << roomCount << ") <<<" << endl;
    for(int i = 0; i < roomCount; i++) {
        cout << "Phong ID: " << rooms[i].getRoomNumber() 
             << " - Gia: " << rooms[i].getPrice() << endl;
    }
    cout << endl;

    cout << ">>> DANH SACH BAC SI (" << doctorCount << ") <<<" << endl;
    for(int i = 0; i < doctorCount; i++) {
        // Đa hình: gọi hàm display() của lớp Doctor
        doctors[i].display(); 
    }
    cout << endl;

    cout << ">>> DANH SACH BENH NHAN (" << patientCount << ") <<<" << endl;
    for(int i = 0; i < patientCount; i++) {
        // Đa hình: gọi hàm display() của lớp Patient
        patients[i].display(); 
    }
}`,
            "main.cpp": `#include <iostream>
#include "Hospital.h"
#include "Doctor.h"
#include "Patient.h"
#include "Room.h"
#include "Medicine.h"
#include "AUTOID.h"

using namespace std;

int main() {
    // Thiết lập hệ thống
    Hospital myHospital;

    // 1. Thêm phòng
    Room r1(500000); // Tự động sinh ID
    Room r2(300000); // Tự động sinh ID
    myHospital.addRoom(r1);
    myHospital.addRoom(r2);

    // 2. Thêm bác sĩ
    Doctor d1("Nguyen Van A", 45, "Tim mach", "Sang (7h-11h)");
    Doctor d2("Tran Thi B", 32, "Than kinh", "Chieu (13h-17h)");
    
    // Ví dụ về hành động chuyên môn
    d1.virter(); 

    myHospital.addDoctor(d1);
    myHospital.addDoctor(d2);

    // 3. Thêm bệnh nhân và kê đơn thuốc (sử dụng nạp chồng toán tử)
    Patient p1("Le Van C", 60, r1.getRoomNumber(), "Cao huyet ap");
    Medicine m1("Panadol", 10);
    Medicine m2("Vitamin C", 20);
    p1.addMedicineToRecord(m1);
    p1.addMedicineToRecord(m2);

    Patient p2("Pham Van D", 25, r2.getRoomNumber(), "Dau da day");
    Medicine m3("Gaviscon", 5);
    p2.addMedicineToRecord(m3);

    myHospital.addPatient(p1);
    myHospital.addPatient(p2);

    // 4. Quản lý và hiển thị thông tin hệ thống
    cout << endl;
    myHospital.manageSystem();

    return 0;
}`
        };
        
        const orderedFiles = [
            "AUTOID.h", "Schedule.h", "Medicine.h", "MedicalRecord.h", "Room.h", 
            "Person.h", "Employee.h", "Doctor.h", "Patient.h", "Hospital.h",
            "AUTOID.cpp", "Schedule.cpp", "Medicine.cpp", "MedicalRecord.cpp", "Room.cpp",
            "Person.cpp", "Employee.cpp", "Doctor.cpp", "Patient.cpp", "Hospital.cpp",
            "main.cpp"
        ];

        // --- HÀM TÔ MÀU CÚ PHÁP (MỚI) ---
        function highlightSyntax(code) {
            // 1. Escape HTML trước để tránh lỗi thẻ (Quan trọng)
            let escaped = code.replace(/&/g, "&amp;")
                              .replace(/</g, "&lt;")
                              .replace(/>/g, "&gt;");

            // Bảng màu
            const colors = {
                keyword: '#bd93f9', // Tím: class, if, return, include
                type:    '#ff79c6', // Hồng: int, void, string
                class:   '#8be9fd', // Xanh dương: Class names, cout, cin
                string:  '#ff5555', // Đỏ: String "..."
                comment: '#6272a4', // Xám xanh: Comment
                number:  '#ff5555'  // Đỏ: Số
            };

            // Định nghĩa các Regex
            // Lưu ý: Thứ tự thực hiện rất quan trọng.
            // Chúng ta sẽ dùng chiến thuật "split and reconstruct" để an toàn nhất,
            // nhưng với demo đơn giản, ta sẽ replace theo thứ tự ưu tiên và tránh replace lồng nhau.
            // Để đảm bảo "không dính thẻ lạ", ta sẽ thực hiện replace trên chuỗi đã escape.

            // 1. Strings (Đỏ) - Xử lý trước để tránh keyword nằm trong string
            // Regex bắt "..."
            escaped = escaped.replace(/(".*?")/g, `<span style="color: ${colors.string}">$1</span>`);

            // 2. Comments (Xám/Xanh nhạt) - Xử lý tiếp theo
            // Regex bắt //...
            // Cẩn thận: không được bắt // nằm trong thẻ span (ví dụ <span ...>)
            // Cách đơn giản: Ta tìm // sau khi đã xử lý string. 
            // Tuy nhiên, để an toàn tuyệt đối với HTML tag vừa thêm, ta dùng hàm replace với callback
            // hoặc chia nhỏ chuỗi. Ở đây dùng regex lookbehind/ahead đơn giản có thể phức tạp.
            
            // GIẢI PHÁP AN TOÀN: Tokenize.
            // Tách chuỗi thành các phần: Thẻ HTML và Text thường. Chỉ tô màu Text thường.
            
            const parts = escaped.split(/(<[^>]*>)/g); // Tách bởi các thẻ <...>
            
            for (let i = 0; i < parts.length; i++) {
                if (parts[i].startsWith('<')) {
                    continue; // Bỏ qua thẻ HTML đã có
                }
                
                let text = parts[i];

                // --- XỬ LÝ TRONG PHẦN TEXT ---

                // Comment // (Đến cuối dòng)
                // Lưu ý: Nếu có comment, phần sau đó phải là comment hết, không replace keyword nữa.
                if (text.includes('//')) {
                    const subParts = text.split('//');
                    let newText = subParts[0]; // Phần code trước comment
                    
                    // Xử lý code trước comment
                    newText = highlightKeywords(newText, colors);
                    
                    // Phần comment (nối lại nếu có nhiều dấu //)
                    const commentPart = '//' + subParts.slice(1).join('//');
                    newText += `<span style="color: ${colors.comment}">${commentPart}</span>`;
                    
                    parts[i] = newText;
                } else {
                    // Không có comment, xử lý bình thường
                    parts[i] = highlightKeywords(text, colors);
                }
            }
            
            return parts.join('');
        }

        function highlightKeywords(text, colors) {
            // 3. Keywords (Tím)
            const kws = "class|struct|public|private|protected|static|virtual|friend|return|if|else|for|while|include|using|namespace|pragma|once|new|delete|break|continue";
            const kwRegex = new RegExp(`\\b(${kws})\\b`, 'g');
            text = text.replace(kwRegex, `<span style="color: ${colors.keyword}">$1</span>`);

            // 4. Primitive Types (Hồng)
            const types = "void|int|double|float|bool|char|string|long|const";
            const typeRegex = new RegExp(`\\b(${types})\\b`, 'g');
            text = text.replace(typeRegex, `<span style="color: ${colors.type}">$1</span>`);

            // 5. Custom Classes & Std Objects (Xanh dương)
            const classes = "Doctor|Patient|Hospital|Room|Medicine|Schedule|Person|Employee|MedicalRecord|AUTOID|ostream|iostream|vector|cout|cin|endl";
            const clsRegex = new RegExp(`\\b(${classes})\\b`, 'g');
            text = text.replace(clsRegex, `<span style="color: ${colors.class}">$1</span>`);
            
            // 6. Numbers (Đỏ) - Regex đơn giản cho số nguyên
            text = text.replace(/\b(\d+)\b/g, `<span style="color: ${colors.number}">$1</span>`);

            // 7. Fix Preprocessor (Tô màu cho #include, #pragma)
            // Vì # không phải là word boundary (\b) với include, nên cần xử lý riêng hoặc fix lại
            text = text.replace(/(#)(include|pragma)/g, `<span style="color: ${colors.keyword}">$1$2</span>`);

            return text;
        }
        // --- KẾT THÚC HÀM TÔ MÀU ---


        function renderTabs() {
            let first = true;
            fileListEl.innerHTML = '';
            
            for (const filename of orderedFiles) {
                if (!codeFiles[filename]) continue;

                const div = document.createElement('div');
                div.className = 'file-tab p-3 text-gray-400 hover:text-white text-sm font-mono border-b border-gray-700';
                div.textContent = filename;
                
                div.onclick = (e) => {
                    e.stopPropagation(); 
                    document.querySelectorAll('.file-tab').forEach(t => t.classList.remove('active'));
                    div.classList.add('active');
                    
                    fileNameEl.textContent = filename;
                    // SỬ DỤNG innerHTML và hàm highlightSyntax thay vì textContent
                    codeContentEl.innerHTML = highlightSyntax(codeFiles[filename]);
                };

                if (first) {
                    div.classList.add('active');
                    fileNameEl.textContent = filename;
                    // SỬ DỤNG innerHTML và hàm highlightSyntax thay vì textContent
                    codeContentEl.innerHTML = highlightSyntax(codeFiles[filename]);
                    first = false;
                }

                fileListEl.appendChild(div);
            }
        }

        function openModal() {
            codeHostMaximized.appendChild(codeDisplayArea);
            codeDisplayArea.classList.remove('h-full', 'w-full'); 
            maximizeButton.style.display = 'none';
            codeModal.style.display = 'block';
            document.body.style.overflow = 'hidden'; 
        }

        function closeModal() {
            codeHostMinimized.appendChild(codeDisplayArea);
            codeDisplayArea.classList.add('h-full', 'w-full'); 
            maximizeButton.style.display = 'flex';
            codeModal.style.display = 'none';
            document.body.style.overflow = '';
        }
        
        function openImageModal(imageSrc) {
            modalImage.src = imageSrc;
            imageModal.style.display = 'flex'; 
            document.body.style.overflow = 'hidden';
        }

        function closeImageModal() {
            imageModal.style.display = 'none';
            if (codeModal.style.display !== 'block') {
                 document.body.style.overflow = '';
            }
        }

        maximizeButton.addEventListener('click', (e) => {
            e.stopPropagation(); 
            openModal();
        });


        window.onclick = function(event) {
            if (event.target == codeModal) {
                closeModal();
            }
            if (event.target == imageModal) {
                closeImageModal();
            }
        }

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && imageModal.style.display === 'flex') {
                closeImageModal();
            }
            if (event.key === 'Escape' && codeModal.style.display === 'block') {
                closeModal();
            }
        });


        document.addEventListener('DOMContentLoaded', () => {
             renderTabs();
        });
    </script>
</body>
</html>
